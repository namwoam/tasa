<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 10. Using SELinux in Buildroot</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="home" href="index.html" title="The Buildroot user manual" /><link rel="up" href="pt02.html" title="Part II. User guide" /><link rel="prev" href="ch09.html" title="Chapter 9. Project-specific customization" /><link rel="next" href="ch11.html" title="Chapter 11. Frequently Asked Questions &amp; Troubleshooting" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch09.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch11.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="selinux"></a>Chapter 10. Using SELinux in Buildroot</h2></div></div></div><p><a class="ulink" href="https://selinuxproject.org" target="_top">SELinux</a> is a Linux kernel security module
enforcing access control policies. In addition to the traditional file
permissions and access control lists, <code class="literal">SELinux</code> allows to write rules
for users or processes to access specific functions of resources
(files, sockets…).</p><p><span class="emphasis"><em>SELinux</em></span> has three modes of operation:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<span class="emphasis"><em>Disabled</em></span>: the policy is not applied
</li><li class="listitem">
<span class="emphasis"><em>Permissive</em></span>: the policy is applied, and non-authorized actions are
  simply logged. This mode is often used for troubleshooting SELinux
  issues.
</li><li class="listitem">
<span class="emphasis"><em>Enforcing</em></span>: the policy is applied, and non-authorized actions are
  denied
</li></ul></div><p>In Buildroot the mode of operation is controlled by the
<code class="literal">BR2_PACKAGE_REFPOLICY_POLICY_STATE_*</code> configuration options. The
Linux kernel also has various configuration options that affect how
<code class="literal">SELinux</code> is enabled (see <code class="literal">security/selinux/Kconfig</code> in the Linux
kernel sources).</p><p>By default in Buildroot the <code class="literal">SELinux</code> policy is provided by the
upstream <a class="ulink" href="https://github.com/SELinuxProject/refpolicy" target="_top">refpolicy</a>
project, enabled with <code class="literal">BR2_PACKAGE_REFPOLICY</code>.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="enabling-selinux"></a>10.1. Enabling SELinux support</h2></div></div></div><p>To have proper support for <code class="literal">SELinux</code> in a Buildroot generated system,
the following configuration options must be enabled:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">BR2_PACKAGE_LIBSELINUX</code>
</li><li class="listitem">
<code class="literal">BR2_PACKAGE_REFPOLICY</code>
</li></ul></div><p>In addition, your filesystem image format must support extended
attributes.</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selinux-policy-tweaking"></a>10.2. SELinux policy tweaking</h2></div></div></div><p>The <code class="literal">SELinux refpolicy</code> contains modules that can be enabled or
disabled when being built. Each module provide a number of <code class="literal">SELinux</code>
rules. In Buildroot the non-base modules are disabled by default and
several ways to enable such modules are provided:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Packages can enable a list of <code class="literal">SELinux</code> modules within the <code class="literal">refpolicy</code> using
  the <code class="literal">&lt;packagename&gt;_SELINUX_MODULES</code> variable.
</li><li class="listitem">
Packages can provide additional <code class="literal">SELinux</code> modules by putting them (.fc, .if
  and .te files) in <code class="literal">package/&lt;packagename&gt;/selinux/</code>.
</li><li class="listitem">
Extra <code class="literal">SELinux</code> modules can be added in directories pointed by the
  <code class="literal">BR2_REFPOLICY_EXTRA_MODULES_DIRS</code> configuration option.
</li><li class="listitem">
Additional modules in the <code class="literal">refpolicy</code> can be enabled if listed in the
  <code class="literal">BR2_REFPOLICY_EXTRA_MODULES_DEPENDENCIES</code> configuration option.
</li></ul></div><p>Buildroot also allows to completely override the <code class="literal">refpolicy</code>. This
allows to provide a full custom policy designed specifically for a
given system. When going this way, all of the above mechanisms are
disabled: no extra <code class="literal">SElinux</code> module is added to the policy, and all
the available modules within the custom policy are enabled and built
into the final binary policy. The custom policy must be a fork of the
official <a class="ulink" href="https://github.com/SELinuxProject/refpolicy" target="_top">refpolicy</a>.</p><p>In order to fully override the <code class="literal">refpolicy</code> the following configuration
variables have to be set:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
<code class="literal">BR2_PACKAGE_REFPOLICY_CUSTOM_GIT</code>
</li><li class="listitem">
<code class="literal">BR2_PACKAGE_REFPOLICY_CUSTOM_REPO_URL</code>
</li><li class="listitem">
<code class="literal">BR2_PACKAGE_REFPOLICY_CUSTOM_REPO_VERSION</code>
</li></ul></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch09.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="pt02.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch11.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>